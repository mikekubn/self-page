import React from 'react';
import type { NextPage } from 'next';
import Head from 'next/head';
import Router from 'next/router';
import { LeftSideHomePage, RightSideHomePage } from '@/components/Sections/HomeSection';
import { useIntersection } from '../hooks';

const Home: NextPage = (): React.ReactElement => {
  const [pathnameHash, setPathnameHash] = React.useState<string>();
  const { visible: visibleHomeSection, add: [homeRef] } = useIntersection({
    root: null,
    rootMargin: '10%',
    threshold: 1,
  });
  const { visible: visibleTechnologySection, add: [technologyRef] } = useIntersection({
    root: null,
    rootMargin: '10%',
    threshold: 1,
  });
  const { visible: visibleContanctSection, add: [contantRef] } = useIntersection({
    root: null,
    rootMargin: '10%',
    threshold: 1,
  });

  React.useEffect(() => {
    if (visibleHomeSection) {
      setPathnameHash('home');
    } else if (visibleTechnologySection) {
      setPathnameHash('technology');
    } else if (visibleContanctSection) {
      setPathnameHash('contact');
    }

    Router.push({
      pathname: '/',
      hash: pathnameHash,
    }, undefined, { scroll: false });
  }, [visibleContanctSection, visibleTechnologySection, visibleHomeSection, pathnameHash]);

  return (
    <>
      <Head>
        <title>Michael Kub√≠n</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.png" />
      </Head>
      <section ref={homeRef} id="home" className="flex h-screen pb-20">
        <LeftSideHomePage />
        <RightSideHomePage />
      </section>
      <section ref={technologyRef} id="technology" className="h-screen bg-green" />
      <section ref={contantRef} id="contact" className="h-screen bg-purple" />
    </>
  );
};

export default Home;
